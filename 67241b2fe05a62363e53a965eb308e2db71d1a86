{
  "comments": [
    {
      "key": {
        "uuid": "dabed58f_e9cdd55e",
        "filename": "jenkins.sh",
        "patchSetId": 2
      },
      "lineNbr": 122,
      "author": {
        "id": 1000072
      },
      "writtenOn": "2015-06-22T15:07:47Z",
      "side": 1,
      "message": "Can you add a few more comments? I\u0027m not sure how the whole loop below works.",
      "revId": "67241b2fe05a62363e53a965eb308e2db71d1a86",
      "serverId": "f33910f19b7abb192b83adbd000000bf",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "dabed58f_c90b312a",
        "filename": "jenkins.sh",
        "patchSetId": 2
      },
      "lineNbr": 122,
      "author": {
        "id": 1000092
      },
      "writtenOn": "2015-06-23T09:02:11Z",
      "side": 1,
      "message": "I\u0027ll try, but you need to be specific about things that are not clear.",
      "parentUuid": "dabed58f_e9cdd55e",
      "revId": "67241b2fe05a62363e53a965eb308e2db71d1a86",
      "serverId": "f33910f19b7abb192b83adbd000000bf",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "dabed58f_0c20779a",
        "filename": "jenkins.sh",
        "patchSetId": 2
      },
      "lineNbr": 122,
      "author": {
        "id": 1000072
      },
      "writtenOn": "2015-06-23T09:23:15Z",
      "side": 1,
      "message": "For instance, why loop with x\"$logserver\" !\u003d x\"\" condition?\n\nWhen using flock -nx, the script is blocked until the lock is granted, right?",
      "parentUuid": "dabed58f_c90b312a",
      "revId": "67241b2fe05a62363e53a965eb308e2db71d1a86",
      "serverId": "f33910f19b7abb192b83adbd000000bf",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "dabed58f_ec3643e7",
        "filename": "jenkins.sh",
        "patchSetId": 2
      },
      "lineNbr": 122,
      "author": {
        "id": 1000092
      },
      "writtenOn": "2015-06-23T09:27:55Z",
      "side": 1,
      "message": "The condition is, essentially, \"while true;\", but we need to skip this part if $logserver is not specified.\n\nThe \"-n\" option to flock makes it non-block.  I tried to make locking blocking, but that is more difficult to get right and avoid dead-locks.  I opted for busy-wait style instead, which is easier to debug.",
      "parentUuid": "dabed58f_0c20779a",
      "revId": "67241b2fe05a62363e53a965eb308e2db71d1a86",
      "serverId": "f33910f19b7abb192b83adbd000000bf",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "dabed58f_89da1916",
        "filename": "jenkins.sh",
        "patchSetId": 2
      },
      "lineNbr": 141,
      "author": {
        "id": 1000072
      },
      "writtenOn": "2015-06-22T15:07:47Z",
      "side": 1,
      "message": "This can only fail when $basedir does not exist, right?",
      "revId": "67241b2fe05a62363e53a965eb308e2db71d1a86",
      "serverId": "f33910f19b7abb192b83adbd000000bf",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "dabed58f_e908752f",
        "filename": "jenkins.sh",
        "patchSetId": 2
      },
      "lineNbr": 141,
      "author": {
        "id": 1000092
      },
      "writtenOn": "2015-06-23T09:02:11Z",
      "side": 1,
      "message": "This can happen for a variety of reasons, from manual log cleanup to adding a new target triplet to testing coverage.",
      "parentUuid": "dabed58f_89da1916",
      "revId": "67241b2fe05a62363e53a965eb308e2db71d1a86",
      "serverId": "f33910f19b7abb192b83adbd000000bf",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "dabed58f_a9d7ddec",
        "filename": "jenkins.sh",
        "patchSetId": 2
      },
      "lineNbr": 154,
      "author": {
        "id": 1000072
      },
      "writtenOn": "2015-06-22T15:07:47Z",
      "side": 1,
      "message": "What is the purpose of this test?",
      "revId": "67241b2fe05a62363e53a965eb308e2db71d1a86",
      "serverId": "f33910f19b7abb192b83adbd000000bf",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "dabed58f_89053916",
        "filename": "jenkins.sh",
        "patchSetId": 2
      },
      "lineNbr": 154,
      "author": {
        "id": 1000092
      },
      "writtenOn": "2015-06-23T09:02:11Z",
      "side": 1,
      "message": "In the \"ssh flock\" above we can\u0027t get exit code from flock, so the way we figure out whether we got the lock or not is by looking for a unique marker inside it.",
      "parentUuid": "dabed58f_a9d7ddec",
      "revId": "67241b2fe05a62363e53a965eb308e2db71d1a86",
      "serverId": "f33910f19b7abb192b83adbd000000bf",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "dabed58f_6c2b3383",
        "filename": "jenkins.sh",
        "patchSetId": 2
      },
      "lineNbr": 154,
      "author": {
        "id": 1000072
      },
      "writtenOn": "2015-06-23T09:23:15Z",
      "side": 1,
      "message": "Why not? Doesn\u0027t ssh return the exit code from flock?",
      "parentUuid": "dabed58f_89053916",
      "revId": "67241b2fe05a62363e53a965eb308e2db71d1a86",
      "serverId": "f33910f19b7abb192b83adbd000000bf",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "dabed58f_ac304be9",
        "filename": "jenkins.sh",
        "patchSetId": 2
      },
      "lineNbr": 154,
      "author": {
        "id": 1000092
      },
      "writtenOn": "2015-06-23T09:27:55Z",
      "side": 1,
      "message": "Because ssh will return only when the lock ceases to exist -- at the end of the build.  Note the \"\u0026\" in the invocation of ssh.  I\u0027ll add a comment about this.",
      "parentUuid": "dabed58f_6c2b3383",
      "revId": "67241b2fe05a62363e53a965eb308e2db71d1a86",
      "serverId": "f33910f19b7abb192b83adbd000000bf",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "dabed58f_c9d011fa",
        "filename": "jenkins.sh",
        "patchSetId": 2
      },
      "lineNbr": 156,
      "author": {
        "id": 1000072
      },
      "writtenOn": "2015-06-22T15:07:47Z",
      "side": 1,
      "message": "Could you add a comment to highlight that this \u0027break\u0027 is what makes the script jump to the actual build code?\nIt took me a while to notice it :-(",
      "revId": "67241b2fe05a62363e53a965eb308e2db71d1a86",
      "serverId": "f33910f19b7abb192b83adbd000000bf",
      "unresolved": false
    },
    {
      "key": {
        "uuid": "dabed58f_a9027d09",
        "filename": "jenkins.sh",
        "patchSetId": 2
      },
      "lineNbr": 156,
      "author": {
        "id": 1000092
      },
      "writtenOn": "2015-06-23T09:02:11Z",
      "side": 1,
      "message": "OK.",
      "parentUuid": "dabed58f_c9d011fa",
      "revId": "67241b2fe05a62363e53a965eb308e2db71d1a86",
      "serverId": "f33910f19b7abb192b83adbd000000bf",
      "unresolved": false
    }
  ]
}